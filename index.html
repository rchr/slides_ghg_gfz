<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Richard Redweik &amp; Stefan Lüdtke" />
  <title>CityGML - Applications, Open Data and Open Source Tools</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="reveal.js/css/reveal.css"/>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">
  <!-- If the query includes 'print-pdf', include the PDF print sheet -->
  <script>
    if( window.location.search.match( /print-pdf/gi ) ) {
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = 'reveal.js/css/print/pdf.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
  </script>
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
  <style type="text/css">
  		.reveal h1 { font-size: 2.0em; }
  		.reveal h2 { font-size: 1.7em; }
  </style>
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
    <h1 class="title">CityGML - Applications, Open Data and Open Source Tools</h1>
    <h2 class="author">Richard Redweik &amp; Stefan Lüdtke</h2>
    <h3 class="date">22. - 23. November 2015</h3>
</section>

<section id="section" class="level1">
<h1></h1>
<section id="working-with-citygml" class="level2">
<h2>Working with CityGML</h2>
</section>
<section id="recap" class="level2">
<h2>Recap</h2>
<p>Application independent geospatial information model</p>
<p>Different thematic areas (buildings, water, vegetation, bridges etc.) International OGC standard <strong>Data model (UML)</strong> and <strong>exchange format</strong> (based on GML3) CityGML represents</p>
<ul>
<li>3D geometrey, 3D topology, semantics, and appearance</li>
<li>in 5 discrete scales (levels of detail, LOD)</li>
</ul>
<p><strong>However!</strong></p>
<p>CityGML datasets may become very large --&gt; Use database to work with!</p>
</section>
<section id="need-for-database-some-examples" class="level2">
<h2>Need for database? some examples</h2>
<ul>
<li>multiple simultaneous changes to data (concurrency)</li>
<li>data changes on a regular basis</li>
<li>large data sets where you only need some observations/ variables</li>
<li>share huge data set among many people (data consistency in a working groug!)</li>
<li>rapid queries</li>
<li>web interfaces to data, especially dynamic data</li>
<li>data bases are collections of tables (2d with columns and rows)</li>
<li>very good for combining information from several tables</li>
</ul>
</section>
</section>
<section id="section-1" class="level1">
<h1></h1>
<section id="agenda" class="level2">
<h2>Agenda</h2>
<ul>
<li>3D City Database</li>
<li>3D City Database Importer/Exporter</li>
<li>QGIS</li>
</ul>
</section>
</section>
<section id="section-2" class="level1">
<h1></h1>
<section id="dcitydb-overview" class="level2">
<h2>3DCityDB-Overview</h2>
<figure>
<img src="./pictures/3DCityDB_System.png" alt="Source: Kunde, 2014" /><figcaption>Source: <a href="http://slides.com/fxku/3d-city-database#/">Kunde, 2014</a></figcaption>
</figure>
</section>
</section>
<section id="section-3" class="level1">
<h1></h1>
<section id="dcitydb-details" class="level2">
<h2>3DCityDB-Details</h2>
<p>Free 3D geo database</p>
<p>Enables to store, represent, and manage virtual 3D city models</p>
<p>Realized as relational database schema for:</p>
<ul>
<li><strong>PostgreSQL/PostGIS</strong></li>
<li>Oracle Spatial</li>
</ul>
</section>
</section>
<section id="section-4" class="level1">
<h1></h1>
<section id="postgresql" class="level2">
<h2>PostgreSQL</h2>
<ul>
<li><p>Relational Database Management System (RDBMS)</p></li>
<li><p><strong>Open Source</strong></p></li>
<li><p>Strong reputation for <strong>reliability</strong>, <strong>data integrity</strong> and <strong>correctness</strong></p></li>
<li><p>Very good documentation</p></li>
<li><p>Runs on Linux, Unix (MacOS, BSD), Windows</p></li>
<li><p>pgAdmin as GUI for administration</p></li>
</ul>
</section>
<section id="postgresql-and-postgis" class="level2">
<h2>PostgreSQL and PostGIS</h2>
<figure>
<img src="./pictures/icon_postgresql.png" alt="icon" /><figcaption>icon</figcaption>
</figure>
<ul>
<li>PostgreSQL is a powerful, <em>open source</em> object-relational database system</li>
<li>&gt; 15 years of active development and a proven architecture</li>
<li>runs on all major operating systems, including Linux, UNIX (AIX, BSD, HP-UX, SGI IRIX, Mac OS X, Solaris, Tru64), and Windows</li>
<li>It includes most SQL:2008 data types, including INTEGER, NUMERIC, BOOLEAN, CHAR, VARCHAR, DATE, INTERVAL, and TIMESTAMP</li>
<li>It also supports storage of binary large objects, including pictures, sounds, or video</li>
<li>diverse native programming interfaces (C/C++, Java, .Net, Perl, Python, ... )</li>
<li>comprehensive documentation</li>
</ul>
</section>
<section id="key-features" class="level2">
<h2>Key features</h2>
<table>
<colgroup>
<col style="width: 37%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Limit</th>
<th style="text-align: center;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Database Size</td>
<td style="text-align: center;">Unlimited</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maximum Table Size</td>
<td style="text-align: center;">32 TB</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maximum Row Size</td>
<td style="text-align: center;">1.6 TB</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maximum Field Size</td>
<td style="text-align: center;">1 GB</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maximum Rows per Table</td>
<td style="text-align: center;">Unlimited</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maximum Columns per Table</td>
<td style="text-align: center;">250 - 1600 depending on column types</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maximum Indexes per Table</td>
<td style="text-align: center;">Unlimited</td>
</tr>
</tbody>
</table>
</section>
<section id="architecture" class="level2">
<h2>Architecture</h2>
<ul>
<li>The library (frontend) sends user requests over the network to the postmaster.</li>
<li>Postmaster starts a new backend server process and connects the frontend process to the new server.</li>
<li>Frontend process and the backend server communicate without intervention by the postmaster.</li>
<li>the postmaster and the backend always run on the same machine (the database server), while the frontend application may run anywhere.</li>
<li>data base server can contain many databases</li>
<li>PostgreSQL uses a message-based protocol for communication between frontends and backends (clients and servers)</li>
<li>The protocol is supported over TCP/IP</li>
</ul>
</section>
<section id="section-5" class="level2">
<h2></h2>
<figure>
<img src="./pictures/client_server.png" alt="client server" /><figcaption>client server</figcaption>
</figure>
</section>
<section id="sql" class="level2">
<h2>SQL</h2>
<ul>
<li>Structured Query Language</li>
<li>... is a computer language to save, edit and query data in relational data bases</li>
<li>first version in 1974 (IBM)</li>
<li>SQL became a standard of the American National Standards Institute (ANSI) in 1986</li>
<li>revised in 1999: SQL99 or SQL3</li>
<li>SQL has standards but also some pecularities depending on the database management system</li>
<li>'Talk' to the database server</li>
<li>used as front end for postgresql</li>
<li>case sensitive (usually upper case for keywords)</li>
</ul>
</section>
<section id="ways-to-use-sql" class="level2">
<h2>ways to use SQL</h2>
<ul>
<li><p>console command (psql -h hostaddress -U db_name)</p></li>
<li><p>GUI (pgadmin)</p></li>
<li><p>interfaces to programming languages (R, python, PHP, etc.)</p></li>
</ul>
</section>
<section id="sql-syntax-i" class="level2">
<h2>SQL syntax-I</h2>
<ul>
<li>create database</li>
</ul>
<pre><code>CREATE TABLE measurements(id BIGINT NOT NULL DEFAULT, date TIMESTAMP WITH TIME ZONE, value DOUBLE PRECISION);</code></pre>
<ul>
<li>save data</li>
</ul>
<pre><code>INSERT INTO mesuremetns VALUES(&#39;2014-09-01&#39;, 10.456);</code></pre>
<ul>
<li>edit data</li>
</ul>
<pre><code>UPDATE measurements SET value = value + 1;</code></pre>
</section>
<section id="sql-syntax-ii" class="level2">
<h2>SQL syntax-II</h2>
<ul>
<li>query data</li>
</ul>
<pre><code>SELECT value FROM measurements;</code></pre>
<ul>
<li>comparison</li>
</ul>
<pre><code>SELECT value FROM measurements WHERE date &gt; &#39;2013-01-01&#39;;</code></pre>
<ul>
<li>summary and computations</li>
</ul>
<pre><code>SELECT MAX(value) AS max_val FROM measurements WHERE date &gt; &#39;2013-01-01&#39;</code></pre>
</section>
</section>
<section id="section-6" class="level1">
<h1></h1>
<section id="postgis" class="level2">
<h2>PostGIS</h2>
<ul>
<li><p>Spatial extension for PostgreSQL</p></li>
<li><p>Support for spatial objects (geometry, geography, raster)</p></li>
<li><p>Spatial functions</p></li>
<li><p>Multi-dimensional spatial indexing</p></li>
</ul>
</section>
<section id="additional-data-type-for-a-geometry" class="level2">
<h2>Additional data type for a geometry</h2>
<p>The geometry is stored in a extra column, usually termed <em>geom</em> or <em>the_geom</em>, all based the following <a href="http://postgis.net/docs/manual-2.1/using_postgis_dbmanagement.html">link</a></p>
<ul>
<li>uses Well-Known Binary (WKB) and Well-Known Text (WKT) Representations defined by <em>OGC</em></li>
<li>POINT (0 0)</li>
<li>LINESTRING (0 0,1 1,1 2)</li>
<li>POLYGON ((0 0,4 0,4 4,0 4,0 0),(1 1, 2 1, 2 2, 1 2,1 1))</li>
<li>MULTIPOINT ((0 0),(1 2))</li>
<li>MULTILINESTRING ((0 0,1 1,1 2),(2 3,3 2,5 4))</li>
</ul>
</section>
<section id="postgis-provides" class="level2">
<h2>PostGIS provides</h2>
<ul>
<li>Processing and analytic functions for both vector and raster data for splicing, dicing, morphing, reclassifying, and collecting/unioning with the power of SQL</li>
<li>raster map algebra for fine-grained raster processing</li>
<li>Spatial reprojection SQL callable functions for both vector and raster data</li>
<li>Support for importing / exporting ESRI shapefile vector data via both commandline and GUI packaged tools and support for more formats via other 3rd-party Open Source tools</li>
<li>Packaged command-line for importing raster data from many standard formats: GeoTiff, NetCDF, PNG, JPG to name a few</li>
<li>Rendering and importing vector data support functions for standard textual formats such as KML,GML, GeoJSON,GeoHash and WKT using SQL</li>
<li>Rendering raster data in various standard formats GeoTIFF, PNG, JPG, NetCDF, to name a few using SQL</li>
<li>Seamless raster/vector SQL callable functions for extrusion of pixel values by geometric region, running stats by region, clipping rasters by a geometry, and vectorizing rasters</li>
<li>3D object support, spatial index, and functions</li>
<li>Network Topology support</li>
</ul>
</section>
<section id="postgis-functions" class="level2">
<h2>PostGIS functions</h2>
<p><strong>the PostGIS extension offers <em>full</em> GIS functionality ...</strong></p>
<ul>
<li>reprojection</li>
<li>area calculations</li>
<li>intersect, union, merge ...</li>
</ul>
<p><br />
<br />
</p>
<p><strong>... among all data-types</strong></p>
<ul>
<li>all vector types supported (point, line, area ...)</li>
<li>raster layers supported as well</li>
</ul>
<p><br />
<br />
</p>
<p><strong>and standard interfaces for visualization</strong></p>
<ul>
<li>QGIS, GRASS spatial layers from a Postgres DB out of the box</li>
<li>ArcMap is supposed to do so as well</li>
</ul>
</section>
<section id="st_-functions" class="level2">
<h2>ST_() Functions</h2>
<p>A bunch of ST_() Functions are available to work with the <em>geom</em> column</p>
<ul>
<li>getting the CRS of the table/layer</li>
</ul>
<pre><code>SELECT ST_SRID(geom) from catchments;</code></pre>
<ul>
<li>re-project a column into a different CRS</li>
</ul>
<pre><code>UPDATE subbasins SET geom = ST_TRANSFORM(geom, 4326);</code></pre>
</section>
<section id="postgis---example" class="level2">
<h2>PostGIS - Example</h2>
<pre><code>SELECT name, pop FROM cities 
WHERE pop &lt; 300000  
AND ST_Area(cities.the_geom) &lt; 400000000;</code></pre>
</section>
</section>
<section id="section-7" class="level1">
<h1></h1>
<section id="d-city-database-importerexporter" class="level2">
<h2>3D City Database Importer/Exporter</h2>
<p>Front-end for 3D city database</p>
<p>Allows importing and exporting of CityGML data into/from 3DCityDB</p>
<p>Allows export in KML and COLLADA for visualization</p>
<p>Offers GUI and CLI</p>
</section>
</section>
<section id="section-8" class="level1">
<h1></h1>
<section id="dcitydb-overview-1" class="level2">
<h2>3DCityDB-Overview</h2>
<figure>
<img src="./pictures/3DCityDB_System.png" alt="Source: Kunde, 2014" /><figcaption>Source: <a href="http://slides.com/fxku/3d-city-database#/">Kunde, 2014</a></figcaption>
</figure>
</section>
</section>
<section id="section-9" class="level1">
<h1></h1>
<section id="qgis" class="level2">
<h2>QGIS</h2>
<p>Previously known as <em>Quantum GIS</em></p>
<p>Open source Geographic Information System (GIS)</p>
<p>Integration of <strong>PostGIS</strong> and GRASS</p>
<p>Runs on Linux, Unix, MacOS, Windows, Android</p>
<p>Supports many vector, raster, and database formats and functionalities</p>
<p>Customizable via plugins (C++, Python)</p>
</section>
</section>
<section id="section-10" class="level1">
<h1></h1>
<section id="d-city-model-berlin" class="level2">
<h2>3D City Model Berlin</h2>
<p>550.000 buildings on about 890 sqkm</p>
<p>LOD2 building models with facade textures</p>
<p>Can be downloaded and used as part of Berlin's Open Data Initiative</p>
<p>Berlin 3D - <a href="http://www.businesslocationcenter.de/en/downloadportal">Download Portal</a></p>
</section>
</section>
<section id="section-11" class="level1">
<h1></h1>
<section id="data-modelling" class="level2">
<h2>Data modelling</h2>
<p>is <strong>fundamental</strong> for efficient</p>
<ul>
<li>storage of data</li>
<li>data maintenance</li>
<li>work with data</li>
</ul>
</section>
<section id="database-normalisation" class="level2">
<h2>Database normalisation</h2>
<p>Normalisation is the formalisation of the design process of making a database compliant with the concept of a Normal Form.</p>
<p>It addresses various ways in which we may look for repeating data values in a table.</p>
<p>There are several levels of the Normal Form, and each level requires that the previous level be satisfied.</p>
<p>The normalization process is based on collecting an exhaustive list of all data items to be maintained in the database and starting the design with a few &quot;superset&quot; tables.</p>
</section>
<section id="normalisation--first-normal-form" class="level2">
<h2>Normalisation- First Normal Form</h2>
<p>For best results, start with a reasonable breakdown of all attributes in different tables</p>
<p>Reduce entities to first normal form (1NF) by removing repeating or multivalued attributes to another, child entity.</p>
<p>Basically, make sure that the data is represented as a (proper) table.</p>
<p>While key to the relational principles, this is somewhat a motherhood statement.</p>
</section>
<section id="normalisation--first-normal-form-1" class="level2">
<h2>Normalisation- First Normal Form</h2>
<p>However, there are six properties of a relational table (the formal name for &quot;table&quot; is &quot;relation&quot;):</p>
<ol type="1">
<li>Entries in columns are single-valued.</li>
<li>Entries in columns are of the same kind.</li>
<li>Each row is unique.</li>
<li>Sequence of columns is insignificant.</li>
<li>Sequence of rows is insignificant.</li>
<li>Each column has a unique name.</li>
</ol>
<p><br />
 The most common sins against the first normal form (1NF) are the lack of a Primary Key and the use of &quot;repeating columns.&quot;</p>
</section>
<section id="normalisation--second-normal-form" class="level2">
<h2>Normalisation- Second Normal Form</h2>
<p>Reduce first normal form entities to second normal form (2NF) by removing attributes that are not dependent on the whole primary key.</p>
<p>The purpose here is to make sure that each column is defined in the correct table. Using the more formal names may make this a little clearer. Make sure each attribute is kept with the entity that it describes.</p>
</section>
<section id="normalisation--third-normal-form" class="level2">
<h2>Normalisation- Third Normal Form</h2>
<p>Reduce second normal form entities to third normal form (3NF) by removing attributes that depend on other, non-key attributes (other than alternative keys).</p>
<p>This basically means that we shouldn't store any data that can either be derived from other columns or belong in another table</p>
<p><br />
<br />
 * for more background and guidance <a href="http://www.codeguru.com/csharp/.net/net_data/article.php/c19615/Introduction-to-Relational-Databases--Part-1-Theoretical-Foundation.htm">code guru</a></p>
</section>
</section>
<section id="section-12" class="level1">
<h1></h1>
<section id="hands-on" class="level2">
<h2>Hands-On</h2>
<p>Create Database</p>
<p>Create 3D City Database</p>
<p>Import City Model</p>
<p>Inspect Database with pgAdmin</p>
<p>Export building data with QGIS</p>
</section>
</section>
<section id="section-13" class="level1">
<h1></h1>
<section id="create-database" class="level2">
<h2>Create Database</h2>
<p>Execute following statement as PostgreSQL admin:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">CREATE</span> <span class="kw">DATABASE</span> ghg_handson
<span class="kw">WITH</span> OWNER = ghg;</code></pre></div>
<p>... and to enable PostGIS:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">CREATE</span> EXTENSION postgis;</code></pre></div>
<p>It is already done on the VM! \o/</p>
</section>
</section>
<section id="section-14" class="level1">
<h1></h1>
<section id="create-3d-city-database-3dcitydb" class="level2">
<h2>Create 3D City Database (3DCityDB)</h2>
<p>The 3DCityDB is a relational database schema</p>
<p>Schema results from a mapping of the object-oriented data model of CityGML to the relational data model of the RDBMS</p>
<p>Schema is like a 'blueprint' of the database</p>
<p>To create the schema with its tables execute:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">cd</span> /home/ghg/Documents/3DCityDB-3.0.0-postgis/PostgreSQL/SQLScripts/
<span class="kw">psql</span> ghg_handson -f CREATE_DB.sql</code></pre></div>
</section>
<section id="section-15" class="level2">
<h2></h2>
<p>Setup requires user input:</p>
<ol type="1">
<li>Spatial Reference Identifier for geometry objects (SRID):</li>
</ol>
<p><strong>25833</strong></p>
<ol start="2" type="1">
<li>GML conformant URN encoding for gml:srsName attributes:</li>
</ol>
<p><strong>urn:ogc:def:crs,crs:EPSG::25833,crs:EPSG::5783</strong></p>
</section>
</section>
<section id="section-16" class="level1">
<h1></h1>
<section id="import-city-model" class="level2">
<h2>Import City Model</h2>
<p>Start 3D City Database Importer/Exporter <img src="./pictures/impexp.png" alt="impexp" /></p>
</section>
<section id="connect-to-database" class="level2">
<h2>Connect to Database</h2>
<figure>
<img src="./pictures/impexp_database.png" alt="" />
</figure>
</section>
<section id="do-the-import" class="level2">
<h2>Do the import</h2>
<figure>
<img src="./pictures/impexp_import.png" alt="" />
</figure>
</section>
</section>
<section id="play-around-with-pgadmin" class="level1">
<h1>Play around with pgAdmin</h1>
</section>
<section id="section-17" class="level1">
<h1></h1>
<section id="export-data-with-qgis" class="level2">
<h2>Export data with QGIS</h2>
</section>
<section id="start-qgis" class="level2">
<h2>Start QGIS</h2>
<ol type="1">
<li><p>Open QGIS Desktop</p></li>
<li><p>Add new database:</p>
<ol type="1">
<li><p>Click on the PostGIS logo (Elephant)</p></li>
<li><p>Select 'New'</p></li>
</ol></li>
</ol>
</section>
<section id="add-new-database" class="level2">
<h2>Add New Database</h2>
<figure>
<img src="./pictures/qgis_database.png" alt="" />
</figure>
</section>
<section id="query-buildings-from-db" class="level2">
<h2>Query Buildings from DB</h2>
<p>Open 'Database' &gt; 'DB Manager' &gt; 'DB Manager'</p>
<p>Select database 'ghg_handson' and open 'SQL window'</p>
<figure>
<img src="./pictures/qgis_db2.png" alt="" />
</figure>
</section>
<section id="query-buildings-from-db-cont." class="level2">
<h2>Query Buildings from DB (cont.)</h2>
<p>Execute following query:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">WITH</span>
groundSurfaces <span class="kw">AS</span> (
    <span class="kw">SELECT</span> thematic_surface.* 
    <span class="kw">FROM</span> citydb.thematic_surface <span class="kw">INNER</span> <span class="kw">JOIN</span> citydb.objectclass 
    <span class="kw">ON</span> objectclass.id = thematic_surface.objectclass_id 
    <span class="kw">WHERE</span> classname=<span class="st">&#39;BuildingGroundSurface&#39;</span>
),
surfaceGeometries <span class="kw">AS</span> (
    <span class="kw">SELECT</span> *
    <span class="kw">FROM</span> citydb.surface_geometry <span class="kw">INNER</span> <span class="kw">JOIN</span> groundSurfaces
    <span class="kw">ON</span> groundSurfaces.lod2_multi_surface_id = surface_geometry.parent_id
    <span class="kw">WHERE</span> geometry <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span>
),
heights <span class="kw">AS</span> (
    <span class="kw">SELECT</span> measured_height, surfaceGeometries.*
    <span class="kw">FROM</span> citydb.building <span class="kw">INNER</span> <span class="kw">JOIN</span> surfaceGeometries
    <span class="kw">ON</span> building.id = surfaceGeometries.building_id
)
<span class="kw">SELECT</span> <span class="fu">row_number</span>() <span class="kw">OVER</span>() <span class="kw">As</span> <span class="kw">id</span>, building_id, 
measured_height, ST_Force2d(geometry) <span class="kw">AS</span> footprint <span class="kw">FROM</span> heights;</code></pre></div>
</section>
<section id="query-buildings-from-db-cont.-1" class="level2">
<h2>Query Buildings from DB (cont.)</h2>
<p>Select 'Load as new layer'</p>
<p>'Column with unique integer values' : 'id'</p>
<p>'Geometry column' : 'footprint'</p>
</section>
<section id="query-buildings-from-db-cont.-2" class="level2">
<h2>Query Buildings from DB (cont.)</h2>
<figure>
<img src="./pictures/qgis_db3.png" alt="" />
</figure>
</section>
<section id="buildings-with-attributes" class="level2">
<h2>Buildings with Attributes</h2>
<figure>
<img src="./pictures/qgis_db4.png" alt="" />
</figure>
</section>
<section id="buildings-with-attributes-1" class="level2">
<h2>Buildings with Attributes</h2>
<p>Example building:</p>
<figure>
<img src="./pictures/qgis_building_attribs.png" alt="" />
</figure>
</section>
<section id="export-to-shape-i" class="level2">
<h2>Export to Shape I</h2>
<p>Do a right-click onto the layer:</p>
<figure>
<img src="./pictures/qgis_save_as.png" alt="" />
</figure>
</section>
<section id="export-to-shape-ii" class="level2">
<h2>Export to Shape II</h2>
<figure>
<img src="./pictures/qgis_db6.png" alt="" />
</figure>
</section>
</section>
    </div>
  </div>


  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,         // Display controls in the bottom right corner
        progress: true,         // Display a presentation progress bar
        history: true,          // Push each slide change to the browser history
        center: true,                       // Vertical centering of slides
        maxScale: 1.5,                  // Bounds for smallest/largest possible content scale
        slideNumber: false,                // Display the page number of the current slide
        theme: 'night', // available themes are in /css/theme
        transition: 'fade', // default/cube/page/concave/zoom/linear/fade/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
          { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
//          { src: 'reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; }, }
//          { src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
]});
    </script>
    </body>
</html>
